<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Prabha Graphics - Get a Quote" />
  <title>Prabha Graphics — Get a Quote</title>

  <!-- Favicon -->
  <link rel="icon" href="logo.png" type="image/png">

  <!-- Fonts & Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    *{margin:0;padding:0;box-sizing:border-box}

    :root{
      /* Brand */
      --primary:#D10007;
      --primary-red:#D10007;
      --dark-red:#A00006;
      --white:#ffffff;
      --black:#000000;

      /* Greys */
      --gray-50:#f9fafb;
      --gray-100:#f3f4f6;
      --gray-200:#e5e7eb;
      --gray-600:#4b5563;
      --gray-800:#1f2937;
      --gray-900:#111827;

      /* Old tokens (products layout) */
      --dark:#0f172a;
      --muted:#6b7280;
      --bg:#fbfbfd;
      --card:0 10px 30px rgba(2,6,23,0.06);
      --max:1200px;
      --gap:16px;
      --radius:12px;
      --nav-height:80px;
    }

    html{
      scroll-behavior:smooth;
      height:100%;
    }
    body{
      font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background-color:var(--white);
      color:var(--gray-800);
      overflow-x:hidden;
      min-height:100%;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      -webkit-tap-highlight-color:transparent;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar{width:10px}
    ::-webkit-scrollbar-track{background:var(--gray-100)}
    ::-webkit-scrollbar-thumb{background:var(--primary-red);border-radius:10px}
    ::-webkit-scrollbar-thumb:hover{background:var(--dark-red)}

    /* Skip link */
    .skip-link{
      position:fixed;left:8px;top:8px;background:#000;color:#fff;padding:8px 12px;
      border-radius:8px;z-index:9999;transform:translateY(-120%);transition:transform .18s;
    }
    .skip-link:focus{transform:translateY(0)}

    .container{
      max-width:1280px;
      margin:0 auto;
      padding:0 20px;
    }

    /* ==================== NAVBAR (same as products page) ==================== */
    .navbar{
      position:fixed;
      top:0;left:0;right:0;
      z-index:1000;
      background-color:var(--white);
      transition:all 0.3s ease;
    }
    .navbar.scrolled{
      box-shadow:0 10px 25px rgba(0,0,0,0.1);
    }
    .nav-container{
      max-width:1280px;
      margin:0 auto;
      padding:16px 20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .nav-logo{
      display:flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      transition:transform 0.3s ease;
    }
    .nav-logo:hover{transform:scale(1.05)}
    .logo-img{
      width:44px;
      height:44px;
      border-radius:999px;
      object-fit:contain;
    }
    .logo-text{
      font-weight:700;
      font-size:20px;
      color:var(--gray-800);
    }
    .nav-links{
      display:flex;
      gap:24px;
      list-style:none;
      align-items:center;
    }
    .nav-link{
      color:var(--gray-800);
      text-decoration:none;
      font-weight:500;
      position:relative;
      transition:color 0.3s ease;
      padding-bottom:3px;
    }
    .nav-link::after{
      content:'';position:absolute;bottom:-4px;left:0;width:0;height:2px;
      background-color:var(--primary-red);transition:width 0.3s ease;
    }
    .nav-link:hover::after{width:100%}

    .cta-btn{
      background-color:var(--primary-red);
      color:var(--white);
      border:none;
      padding:10px 24px;
      border-radius:8px;
      font-weight:600;
      cursor:pointer;
      transition:all 0.3s ease;
      font-family:'Poppins',sans-serif;
      white-space:nowrap;
    }
    .cta-btn:hover{
      background-color:var(--dark-red);
      transform:scale(1.05);
    }

    .hamburger{
      display:none;
      flex-direction:column;
      cursor:pointer;
      margin-left:8px;
    }
    .hamburger span{
      width:24px;height:3px;background-color:var(--gray-800);
      margin:4px 0;transition:all 0.3s ease;border-radius:2px;
    }
    .hamburger.active span:nth-child(1){
      transform:rotate(-45deg) translate(-6px,6px);
    }
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){
      transform:rotate(45deg) translate(-6px,-6px);
    }

    /* ==================== HERO (Get a Quote) ==================== */
    .hero{
      min-height:220px;
      background:linear-gradient(90deg,#fff7f7,#fff);
      display:flex;
      align-items:center;
      margin-top:var(--nav-height);
      padding:28px 0;
    }
    .hero-grid{
      display:flex;
      gap:24px;
      align-items:center;
      justify-content:space-between;
    }
    .hero h1{
      font-size:26px;
      margin:0 0 8px 0;
    }
    .hero p{
      color:var(--muted);
      margin:0;
      max-width:58ch;
    }
    .hero-figure{
      width:260px;
      border-radius:12px;
      overflow:hidden;
      flex-shrink:0;
      box-shadow:0 16px 38px rgba(15,23,42,0.15);
    }
    .hero-figure img{
      width:100%;height:100%;display:block;object-fit:cover;
    }

    /* ==================== QUOTE PRODUCTS LIST ==================== */
    .section{margin:18px 0;padding-bottom:6px}
    .section h2{margin:0 0 8px 0;font-size:20px}
    .section p{margin:0 0 8px 0;font-size:14px;color:var(--muted)}

    .quote-filters{
      margin:18px 0 6px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .quote-filters label{
      font-size:13px;
      color:var(--muted);
    }
    #quoteSearch{
      flex:1;
      min-width:180px;
      padding:9px 10px;
      border-radius:8px;
      border:1px solid var(--gray-200);
      font-size:14px;
      font-family:'Poppins',sans-serif;
    }

    .products-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:14px;
    }
    .product-card{
      background:#fff;
      border-radius:12px;
      overflow:hidden;
      box-shadow:var(--card);
      display:flex;
      flex-direction:column;
      transition:transform .18s;
    }
    .product-card:hover{transform:translateY(-6px)}
    .product-card img{
      width:100%;
      height:180px;
      object-fit:cover;
    }
    .product-body{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .product-title{font-size:15px;font-weight:700}
    .product-vendor{color:var(--muted);font-size:13px}
    .product-desc{color:#334155;font-size:13px}
    .product-footer{
      display:flex;
      align-items:center;
      gap:8px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .badge{
      background:#f1f5f9;
      color:#0f172a;
      padding:6px 9px;
      border-radius:999px;
      font-size:12px;
    }
    .price{
      font-weight:800;
      color:var(--primary);
      margin-left:auto;
      white-space:nowrap;
    }
    .old{
      color:#9ca3af;
      text-decoration:line-through;
      font-size:13px;
    }

    .empty{
      padding:24px;
      border-radius:12px;
      background:#fff;
      text-align:center;
      color:var(--muted);
      box-shadow:var(--card);
      font-size:14px;
    }

    /* ==================== QUOTE MODAL ==================== */
    .modal-bg{
      position:fixed;
      inset:0;
      display:none;
      align-items:flex-start;
      justify-content:center;
      background:rgba(15,23,42,0.7);
      z-index:2200;
      padding:32px 12px;
    }
    .modal{
      width:100%;
      max-width:720px;
      background:#ffffff;
      border-radius:18px;
      padding:20px 22px 22px;
      max-height:92vh;
      overflow:auto;
      box-shadow:0 30px 80px rgba(15,23,42,0.6);
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      flex-wrap:wrap;
      padding-bottom:10px;
      border-bottom:1px solid #e5e7eb;
    }
    .modal-title{
      font-size:20px;
      font-weight:700;
      margin:0;
    }
    .modal-sub{
      font-size:13px;
      color:var(--muted);
      margin-top:4px;
    }
    .pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:8px;
      font-size:12px;
    }
    .pill{
      padding:5px 9px;
      border-radius:999px;
      background:#f3f4f6;
      color:#374151;
    }

    /* Order/Quote forms */
    .form-row{
      display:flex;
      gap:10px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .form-row > *{flex:1}
    input,select,textarea{
      width:100%;
      padding:10px;
      border-radius:8px;
      border:1px solid #e6e7eb;
      font-size:14px;
      font-family:'Poppins',sans-serif;
    }
    textarea{resize:vertical}
    label.form-label{
      display:block;
      font-size:13px;
      margin-bottom:4px;
      color:var(--gray-700,#374151);
    }
    .form-section-title{
      margin-top:10px;
      font-size:14px;
      font-weight:600;
      color:var(--gray-800);
    }
    .form-hint{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }
    .q-msg{margin-top:10px}

    .btn{
      background:var(--primary);
      color:#fff;
      padding:10px 14px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      font-weight:700;
      font-family:'Poppins',sans-serif;
      transition:all 0.2s ease;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
      font-size:14px;
    }
    .btn:hover{
      background:var(--dark-red);
      transform:translateY(-1px);
    }
    .btn.ghost{
      background:#fff;
      border:1px solid #e5e7eb;
      color:var(--dark);
    }
    .btn.secondary{
      background:#334155;
    }

    /* ==================== FOOTER (same as products page) ==================== */
    .footer{
      background-color:var(--gray-900);
      color:var(--white);
      padding:64px 0 32px;
      margin-top:28px;
    }
    .footer-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
      gap:40px;
      margin-bottom:40px;
    }
    .footer-col{
      opacity:0;
      animation:slideUp 0.8s ease forwards;
    }
    .footer-col:nth-child(2){animation-delay:0.1s}
    .footer-col:nth-child(3){animation-delay:0.2s}
    .footer-col:nth-child(4){animation-delay:0.3s}

    @keyframes slideUp{
      from{opacity:0;transform:translateY(20px)}
      to{opacity:1;transform:translateY(0)}
    }

    .footer-logo{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:16px;
    }
    .footer-logo-img{
      width:40px;
      height:40px;
      border-radius:999px;
      object-fit:contain;
    }
    .footer-col p{
      color:#d1d5db;
      line-height:1.6;
      margin-bottom:16px;
    }
    .footer-col h3{
      font-size:18px;
      font-weight:600;
      margin-bottom:16px;
    }
    .footer-col ul{list-style:none}
    .footer-col li{margin-bottom:12px}
    .footer-link{
      color:#d1d5db;
      text-decoration:none;
      transition:all 0.3s ease;
    }
    .footer-link:hover{
      color:var(--primary-red);
      transform:translateX(5px);
    }
    .contact-info{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .contact-info p{
      display:flex;
      align-items:flex-start;
      gap:8px;
      color:#d1d5db;
    }
    .contact-info i{
      color:var(--primary-red);
      margin-top:2px;
    }
    .social-links{
      display:flex;
      gap:16px;
      margin-top:16px;
    }
    .social-icon{
      width:40px;
      height:40px;
      background-color:rgba(255,255,255,0.1);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--primary-red);
      text-decoration:none;
      transition:all 0.3s ease;
    }
    .social-icon:hover{
      background-color:var(--primary-red);
      color:var(--white);
      transform:scale(1.2) rotate(10deg);
    }
    .footer-divider{
      height:1px;
      background:linear-gradient(to right,transparent,rgba(209,0,7,0.3),transparent);
      margin-bottom:24px;
    }
    .footer-bottom{
      text-align:center;
      color:#9ca3af;
    }

    /* Scroll to top button */
    #scrollToTop{
      position:fixed;
      bottom:20px;
      right:20px;
      width:50px;
      height:50px;
      background-color:var(--primary-red);
      color:var(--white);
      border:none;
      border-radius:50%;
      cursor:pointer;
      display:none;
      z-index:999;
      font-size:20px;
      transition:all 0.3s ease;
      align-items:center;
      justify-content:center;
    }
    #scrollToTop:hover{
      transform:scale(1.1);
      background-color:var(--dark-red);
    }

    /* ==================== RESPONSIVE ==================== */
    @media (max-width:1024px){
      .hero-grid{flex-direction:column;align-items:flex-start}
      .hero-figure{width:100%;max-width:360px}
      .hero h1{font-size:24px}
      .products-grid{
        grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      }
      .modal{max-width:100%}
    }
    @media (max-width:768px){
      .nav-links{
        display:none;
      }
      .nav-links.active{
        display:flex;
        position:fixed;
        top:var(--nav-height);
        left:0;
        width:100%;
        flex-direction:column;
        background-color:var(--white);
        gap:0;
        padding:16px 0;
        max-height:calc(100vh - var(--nav-height));
        overflow-y:auto;
        box-shadow:0 10px 30px rgba(0,0,0,0.12);
      }
      .nav-links.active li{
        padding:12px 20px;
        border-bottom:1px solid var(--gray-100);
      }
      .hamburger{display:flex}
      .logo-text{font-size:18px}

      .hero{
        min-height:200px;
        padding:18px 0;
      }
      .product-card img{height:140px}
      .products-grid{
        grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      }
      .modal{padding:14px;max-height:95vh}
      .footer-grid{
        grid-template-columns:1fr;
        gap:24px;
      }
    }
    @media (max-width:480px){
      .container{padding:0 16px}
      .nav-container{padding:12px 16px}
      .hero h1{font-size:22px}
      .hero p{font-size:13px}
      .section h2{font-size:18px}
      #scrollToTop{
        width:40px;
        height:40px;
        font-size:16px;
      }
    }

    :focus{outline:3px solid rgba(209,0,7,0.18);outline-offset:2px}
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to main content</a>

  <!-- NAVBAR (exactly same style as products page, with Get a Quote button) -->
  <nav class="navbar" id="navbar">
    <div class="nav-container">
      <div class="nav-logo" onclick="location.href='index.html'" role="button" tabindex="0">
        <img src="logo.png" alt="Prabha Graphics" class="logo-img">
        <span class="logo-text">Prabha Graphics</span>
      </div>

      <ul class="nav-links" id="navLinks">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="about.html" class="nav-link">About Us</a></li>
        <li><a href="products.html#corporate" class="nav-link">Corporate Gifts</a></li>
        <li><a href="products.html#personalized" class="nav-link">Personalized Gifts</a></li>
        <!-- Business Essentials removed in products navigation -->
        <li><a href="contact-us.html" class="nav-link">Contact Us</a></li>
      </ul>

      <button class="cta-btn" onclick="location.href='get-a-quote.html'">Get a Quote</button>

      <div class="hamburger" id="hamburger" aria-label="Toggle navigation" aria-expanded="false">
        <span></span><span></span><span></span>
      </div>
    </div>
  </nav>

  <!-- PAGE CONTENT -->
  <main id="main">
    <!-- HERO -->
    <section class="hero" aria-labelledby="heroTitle">
      <div class="container hero-grid">
        <div class="left">
          <h1 id="heroTitle">Get a Quote — Ask your product questions</h1>
          <p>
            Select any product and tell us your requirements – quantity, printing, logo placement,
            budget or delivery timeline. Your request will go straight to our team in the admin panel.
          </p>
          <p style="margin-top:8px;font-size:13px;color:var(--muted);">
            You can also mention “Custom / Other” if your product is not listed.
          </p>
        </div>
        <figure class="hero-figure" aria-hidden="true">
          <!-- Use any banner image you like -->
          <img loading="lazy" decoding="async" src="banner1.png" alt="Get a quote illustration"/>
        </figure>
      </div>
    </section>

    <div class="container" style="padding-top:6px;">
      <!-- Filters -->
      <div class="quote-filters">
        <label for="quoteSearch">Search products</label>
        <input id="quoteSearch" type="text" placeholder="Search by name / SKU / tag (e.g. mug, t-shirt, visiting card)"/>
      </div>

      <!-- Product list for quote -->
      <section id="quoteSection" class="section" aria-label="Get a quote products section">
        <h2>Choose a product and request a quote</h2>
        <p>
          Click on <strong>“Get a Quote”</strong> for any product, or search above. Your query will be visible
          under <em>“Get-a-Quote Requests”</em> on the admin page.
        </p>
        <div id="quoteGrid" class="products-grid" aria-live="polite" aria-busy="false"></div>
        <div id="quoteEmpty" class="empty" style="display:none">
          No products found. Please add products from the admin panel, or try a different search.
        </div>
      </section>
    </div>

    <!-- Quote modal -->
    <div id="quoteModal" class="modal-bg" role="dialog" aria-hidden="true" aria-labelledby="qModalTitle" aria-modal="true">
      <div class="modal" role="document">
        <div class="modal-header">
          <div>
            <h2 id="qModalTitle" class="modal-title">Request a Quote</h2>
            <div class="modal-sub">
              Share your requirements. We’ll reply with best pricing and options.
            </div>
            <div class="pill-row">
              <span class="pill" id="qProdNamePill">Product: <span id="qProdName">—</span></span>
              <span class="pill">SKU: <span id="qProdSku">—</span></span>
              <span class="pill" id="qProdSummary"></span>
            </div>
          </div>
          <div>
            <button type="button" class="btn ghost" id="qCloseBtn" aria-label="Close quote form">Close</button>
          </div>
        </div>

        <form id="quoteForm" style="margin-top:8px" novalidate>
          <div class="form-section-title">Your contact details</div>
          <div class="form-row">
            <div>
              <label class="form-label" for="qName">Full name *</label>
              <input id="qName" placeholder="Your full name" required aria-required="true"/>
            </div>
            <div>
              <label class="form-label" for="qPhone">Phone / WhatsApp *</label>
              <input id="qPhone" type="tel" placeholder="Phone number (WhatsApp preferred)" required aria-required="true"/>
            </div>
          </div>
          <div class="form-row">
            <div>
              <label class="form-label" for="qEmail">Email (optional)</label>
              <input id="qEmail" type="email" placeholder="you@example.com"/>
            </div>
          </div>

          <div class="form-section-title">Requirement details</div>
          <div class="form-row">
            <div>
              <label class="form-label" for="qQty">Approx. quantity</label>
              <input id="qQty" type="number" min="1" placeholder="e.g. 25, 100, 500"/>
              <div class="form-hint">You can give a range also (e.g. 50–100) in message.</div>
            </div>
            <div>
              <label class="form-label" for="qBudget">Approx. budget (optional)</label>
              <input id="qBudget" type="text" placeholder="e.g. ₹5000 – ₹8000"/>
            </div>
          </div>

          <div class="form-row">
            <div>
              <label class="form-label" for="qMessage">Message / customization details</label>
              <textarea id="qMessage" rows="3" placeholder="Tell us about logo position, colors, print on one side or both, delivery date, etc."></textarea>
            </div>
          </div>

          <label style="display:flex;align-items:center;gap:8px;margin-top:8px">
            <input type="checkbox" id="qWhatsapp"/>
            <span style="color:var(--muted);font-size:13px">
              Also send this quote request to us on WhatsApp
            </span>
          </label>

          <div id="qMsg" class="q-msg" aria-live="polite"></div>

          <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
            <button type="submit" class="btn">
              <i class="fa fa-paper-plane" aria-hidden="true"></i>
              <span>Submit Quote Request</span>
            </button>
            <button type="button" class="btn ghost" id="qCancelBtn">Cancel</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Footer (exactly same layout as products page footer) -->
    <footer class="footer" id="contact">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-col">
            <div class="footer-logo">
              <img src="logo.png" alt="Prabha Graphics" class="footer-logo-img">
              <span>Prabha Graphics</span>
            </div>
            <p>Your trusted partner in Lucknow for all corporate and personalized printing and gifting needs.</p>
          </div>

          <div class="footer-col">
            <h3>Quick Links</h3>
            <ul>
              <li><a href="products.html#corporate" class="footer-link">Corporate Gifts</a></li>
              <li><a href="products.html#personalized" class="footer-link">Personalized Gifts</a></li>
              <li><a href="products.html#other" class="footer-link">Other Products</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h3>Company</h3>
            <ul>
              <li><a href="about.html" class="footer-link">About Us</a></li>
              <li><a href="contact-us.html#contact" class="footer-link">Contact Us</a></li>
              <li><a href="get-a-quote.html" class="footer-link">View Full Catalog</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h3>Contact Us</h3>
            <div class="contact-info">
              <p><i class="fas fa-phone"></i> 074579 94888</p>
              <p><i class="fas fa-map-marker-alt"></i> Shop No. 4/74, Adarsh Market, Gomti Nagar Railway Sta Rd, near TC Eye Centre Road, Vinay Khand 4, Gomti Nagar, Lucknow, Uttar Pradesh 226010</p>
              <p><i class="fas fa-globe"></i> www.prabhagraphics.in</p>
            </div>
            <div class="social-links">
              <a href="https://www.instagram.com/prabhagraphics/" target="_blank" rel="noopener" class="social-icon" aria-label="Instagram">
                <i class="fab fa-instagram"></i>
              </a>
              <a href="#" class="social-icon" aria-label="YouTube">
                <i class="fab fa-youtube"></i>
              </a>
            </div>
          </div>
        </div>

        <div class="footer-divider"></div>
        <div class="footer-bottom">
          <p>&copy; 2025 Prabha Graphics. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </main>

  <button id="scrollToTop"><i class="fas fa-arrow-up"></i></button>

  <!-- Firebase + Get-a-Quote Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
    import {
      getFirestore,
      collection,
      query,
      orderBy,
      onSnapshot,
      addDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

   const firebaseConfig = {
   apiKey: "AIzaSyCADm7aarTkJ4Hohsb2xz1EkqrkLWjSQxg",
   authDomain: "my-project-b3537.firebaseapp.com",
   projectId: "my-project-b3537",
   storageBucket: "my-project-b3537.firebasestorage.app",
   messagingSenderId: "652581310060",
   appId: "1:652581310060:web:c00691e1c625e1a78ad249",
   measurementId: "G-CG17J3F6YW"
 };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const shopPhone = "917457994888"; // wa.me format

    // UI Refs
    const quoteGrid = document.getElementById('quoteGrid');
    const quoteEmpty = document.getElementById('quoteEmpty');
    const quoteSearch = document.getElementById('quoteSearch');

    const quoteModal = document.getElementById('quoteModal');
    const qModalTitle = document.getElementById('qModalTitle');
    const qProdName = document.getElementById('qProdName');
    const qProdSku = document.getElementById('qProdSku');
    const qProdSummary = document.getElementById('qProdSummary');
    const qCloseBtn = document.getElementById('qCloseBtn');
    const qCancelBtn = document.getElementById('qCancelBtn');
    const quoteForm = document.getElementById('quoteForm');
    const qMsg = document.getElementById('qMsg');

    const qName = document.getElementById('qName');
    const qPhone = document.getElementById('qPhone');
    const qEmail = document.getElementById('qEmail');
    const qQty = document.getElementById('qQty');
    const qBudget = document.getElementById('qBudget');
    const qMessage = document.getElementById('qMessage');
    const qWhatsapp = document.getElementById('qWhatsapp');

    let activeProduct = null;
    let allProducts = [];
    window._prabhaProducts = {};

    // Real-time products for quote page (same 'products' collection as product page)
    const qProducts = query(collection(db, 'products'), orderBy('createdAt', 'desc'));
    onSnapshot(qProducts, snapshot => {
      quoteGrid.innerHTML = '';
      allProducts = [];
      window._prabhaProducts = {};

      let count = 0;

      snapshot.forEach(docSnap => {
        const p = docSnap.data();
        p.id = docSnap.id;
        allProducts.push(p);
        window._prabhaProducts[p.id] = p;

        const card = createQuoteProductCard(p);
        quoteGrid.appendChild(card);
        count++;
      });

      if (!count) {
        quoteEmpty.style.display = 'block';
      } else {
        quoteEmpty.style.display = 'none';
      }

      // apply current search (if any)
      filterQuoteProducts();
    });

    function createQuoteProductCard(p){
      const card = document.createElement('div');
      card.className = 'product-card';

      const discount = p.oldPrice && p.price && p.oldPrice > p.price
        ? Math.round(((p.oldPrice - p.price)/p.oldPrice)*100)
        : 0;

      const img = (p.images && p.images[0]) || p.image || p.imageUrl || '';
      const fallbackImg = 'https://placehold.co/400x300/D10007/FFFFFF?text=Product+Image';

      const searchText = (
        (p.name || '') + ' ' +
        (p.sku || '') + ' ' +
        (p.mainCategory || '') + ' ' +
        (p.subCategory || '') + ' ' +
        (p.category || '') + ' ' +
        (p.vendor || '') + ' ' +
        (p.tags || []).join(' ')
      ).toLowerCase();

      card.dataset.search = searchText;

      card.innerHTML = `
        <img loading="lazy" decoding="async" src="${escapeHtml(img || fallbackImg)}" alt="${escapeHtml(p.name || 'Product image')}"/>
        <div class="product-body">
          <div>
            <div class="product-title">${escapeHtml(p.name || '')}</div>
            <div class="product-vendor">${escapeHtml(p.vendor || '')}</div>
          </div>
          <div class="product-desc">
            ${escapeHtml((p.description || '').slice(0,90))}${(p.description || '').length > 90 ? '…' : ''}
          </div>
          <div class="product-footer">
            ${discount
              ? `<span class="badge">-${discount}%</span>`
              : `<span class="badge">${escapeHtml(p.type || 'ready-made')}</span>`}
            ${p.oldPrice
              ? `<span class="old">₹${escapeHtml(String(p.oldPrice))}</span>`
              : ''}
            <div class="price">₹${escapeHtml(String(p.price || 0))}</div>
            <button class="btn" type="button" aria-label="Get a quote for ${escapeHtml(p.name || '')}">
              Get a Quote
            </button>
          </div>
        </div>
      `;

      const btn = card.querySelector('button');
      btn.addEventListener('click', () => openQuote(p.id));

      return card;
    }

    // Search filter
    if (quoteSearch) {
      quoteSearch.addEventListener('input', filterQuoteProducts);
    }

    function filterQuoteProducts(){
      const q = (quoteSearch?.value || '').toLowerCase().trim();
      const cards = quoteGrid.querySelectorAll('.product-card');
      let visible = 0;

      cards.forEach(card => {
        const text = card.dataset.search || (card.textContent || '').toLowerCase();
        const match = !q || text.includes(q);
        card.style.display = match ? '' : 'none';
        if (match) visible++;
      });

      quoteEmpty.style.display = visible ? 'none' : 'block';
    }

    // Open quote modal
    window.openQuote = function(id){
      const p = window._prabhaProducts && window._prabhaProducts[id];
      activeProduct = p || null;

      // Reset form but keep product info above
      quoteForm.reset();
      qMsg.innerHTML = '';

      if (p){
        qModalTitle.textContent = 'Request a Quote';
        qProdName.textContent = p.name || '—';
        qProdSku.textContent = p.sku || '—';
        const catParts = [];
        if (p.mainCategory) catParts.push(p.mainCategory);
        if (p.subCategory) catParts.push(p.subCategory);
        if (!catParts.length && p.category) catParts.push(p.category);
        qProdSummary.textContent = catParts.join(' • ');
      } else {
        qModalTitle.textContent = 'Request a Quote (Custom / Other)';
        qProdName.textContent = 'Custom / Other';
        qProdSku.textContent = '—';
        qProdSummary.textContent = 'Describe your requirement in the message box.';
      }

      quoteModal.style.display = 'flex';
      quoteModal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      trapFocus(quoteModal);
    };

    function closeQuote(){
      quoteModal.style.display = 'none';
      quoteModal.setAttribute('aria-hidden','true');
      activeProduct = null;
      document.body.style.overflow = '';
      releaseTrap();
    }

    qCloseBtn.addEventListener('click', closeQuote);
    qCancelBtn.addEventListener('click', closeQuote);

    // Submit quote -> Firestore 'quotes' collection (admin page already listens to this)
    quoteForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      qMsg.innerHTML = '';

      const name = qName.value.trim();
      const phone = qPhone.value.trim();
      if (!name || !phone) {
        return showQuoteError('Please fill your name and phone / WhatsApp number.');
      }

      const email = qEmail.value.trim();
      const qty = qQty.value.trim();
      const budget = qBudget.value.trim();
      const message = qMessage.value.trim();

      const productName = activeProduct?.name || qProdName.textContent || '';
      const sku = activeProduct?.sku || qProdSku.textContent || '';

      const payload = {
        productId: activeProduct?.id || '',
        productName: productName || 'Custom / Other',
        sku: sku || '',
        name,
        phone,
        email: email || '',
        quantity: qty || '',
        budget: budget || '',
        message: message || '',
        source: 'get-a-quote-page',
        createdAt: serverTimestamp()
      };

      try {
        await addDoc(collection(db, 'quotes'), payload);
        showQuoteSuccess('Your quote request has been submitted. We will contact you soon.');

        if (qWhatsapp.checked){
          const lines = [
            "I have submitted a quote request from your website.",
            `Product: ${productName || 'Custom / Other'}`,
            `SKU: ${sku || '-'}`,
            qty ? `Approx. quantity: ${qty}` : '',
            budget ? `Approx. budget: ${budget}` : '',
            message ? `Details: ${message}` : '',
            "",
            `Name: ${name}`,
            `Phone: ${phone}`,
            email ? `Email: ${email}` : '',
            "",
            "Please share best price and options."
          ].filter(Boolean);
          const waText = lines.join('\n');
          setTimeout(()=> {
            window.open(`https://wa.me/${shopPhone}?text=${encodeURIComponent(waText)}`, '_blank');
          }, 600);
        }

        setTimeout(()=> closeQuote(), 900);
      } catch (err) {
        console.error('quote save failed', err);
        showQuoteError('Could not submit request: ' + err.message);
      }
    });

    function showQuoteError(msg){
      qMsg.innerHTML = `
        <div style="background:#fee2e2;padding:10px;border-radius:8px;color:#991b1b;font-size:13px">
          ${escapeHtml(msg)}
        </div>`;
    }
    function showQuoteSuccess(msg){
      qMsg.innerHTML = `
        <div style="background:#dcfce7;padding:10px;border-radius:8px;color:#065f46;font-size:13px">
          ${escapeHtml(msg)}
        </div>`;
    }

    // Helpers
    function escapeHtml(s=''){
      return String(s).replace(/[&<>\"']/g, m=> ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
      }[m]));
    }

    // Simple focus trap for modal
    let _trap = null;
    function trapFocus(container){
      releaseTrap();
      const focusable = container.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');
      if (!focusable.length) return;
      const first = focusable[0];
      const last = focusable[focusable.length-1];
      _trap = function(e){
        if (e.key === 'Tab'){
          if (e.shiftKey && document.activeElement === first) {
            e.preventDefault(); last.focus();
          } else if (!e.shiftKey && document.activeElement === last) {
            e.preventDefault(); first.focus();
          }
        }
      };
      container.addEventListener('keydown', _trap);
      setTimeout(()=> first && first.focus(), 50);
    }
    function releaseTrap(){
      if(!_trap) return;
      quoteModal.removeEventListener('keydown', _trap);
      _trap = null;
    }

    // ESC key closes modal
    document.addEventListener('keydown', (e)=> {
      if (e.key === 'Escape' && quoteModal.style.display === 'flex') {
        closeQuote();
      }
    });

    console.log('✅ Get-a-Quote page loaded – products synced from Firestore, requests saved to "quotes" collection.');
  </script>

  <!-- Header / navbar JS (same behaviour as products page) -->
  <script>
    const navbarEl = document.getElementById('navbar');
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('navLinks');
    const scrollToTopBtn = document.getElementById('scrollToTop');

    // Navbar scroll effect
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        navbarEl.classList.add('scrolled');
      } else {
        navbarEl.classList.remove('scrolled');
      }

      // Scroll to top visibility
      if (window.scrollY > 300) {
        scrollToTopBtn.style.display = 'flex';
      } else {
        scrollToTopBtn.style.display = 'none';
      }
    });

    // Hamburger menu
    hamburger.addEventListener('click', () => {
      const isActive = hamburger.classList.toggle('active');
      navLinks.classList.toggle('active');
      hamburger.setAttribute('aria-expanded', isActive ? 'true' : 'false');
    });

    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        hamburger.classList.remove('active');
        navLinks.classList.remove('active');
        hamburger.setAttribute('aria-expanded','false');
      });
    });

    // Smooth scroll only for same-page hashes (if you ever add them here)
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          e.preventDefault();
          target.scrollIntoView({ behavior:'smooth', block:'start' });
        }
      });
    });

    // Scroll to top
    scrollToTopBtn.addEventListener('click', () => {
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // Keyboard support for nav menu close on ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        hamburger.classList.remove('active');
        navLinks.classList.remove('active');
        hamburger.setAttribute('aria-expanded','false');
      }
    });
  </script>
</body>
</html>
